{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="{% static 'portal/bootstrap.min.css' %}">
    <script src="{% static 'portal/bootstrap.bundle.min.js' %}"></script>
    <script src="{% static 'portal/jobs_applied.js'%}"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>user</title>
    <script>
        function validateSearch(){
            const value = document.getElementById("searchInput").value.trim();
            if(value === ""){

                document.querySelector(".modal-body").innerHTML = "Fill the input field";
                const modal = new bootstrap.Modal(document.getElementById('exampleModal'));
                modal.show();
                return false;

            }
            return true;
            
        }

        document.addEventListener("DOMContentLoaded",()=>{

            document.getElementById("searchInput").addEventListener("input",function(){

                if(this.value.trim() === ""){
                    this.form.submit();
                }

            });

        });
        
    </script>

</head>
<body style="background-color:azure;">
    {% csrf_token %}
    <nav class="navbar navbar-expand-lg sticky-top navbar-dark bg-dark">
        <div class="container-fluid">
            <p class="navbar-brand">{{first}} {{last}}</p>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link active" href="{% url 'index'%}">Jobs</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link " href="{% url 'applied'%}">My Jobs</a>
                    </li>
                     <li class="nav-item">
                        <a class="nav-link " href="{% url 'profile'%}">Profile</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'logout'%}">logout</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <div class="container">
        <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel">Application Status</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
                </div>
            </div>
        </div>
        <form id="form" class="d-flex mt-3" method="get" onsubmit=" return validateSearch()">
            {% csrf_token %}
            <input autocomplete="off" id="searchInput" name="q" class="form-control form-control-sm me-2 rounded w-75 shadow-none" type="search" placeholder="Search with company, role, location. one at a time." aria-label="Search" value="{{query}}" >
            <button class="btn btn-sm btn-outline-secondary" type="submit">Search</button>
        </form>

        <div class="mt-3">
           
            <ul class="list-group">
                {% for job in jobs %}
                    <li class="shadow shadow-sm rounded mb-3 list-group-item" style="background-color:cornsilk;">
                        <button class="btn btn-success btn-sm float-end ms-2" id="apply_button" data-job_id="{{job.id}}">Apply</button>
                        <button class="btn btn-warning btn-sm float-end" id="see-more" data-id="{{job.id}}" >see more</button>
                        <h5 style="font-size:14px;">{{job.employer.company_name}}</h5>
                        <div style="font-size:14px;" class="fw-bold">{{job.title}}</div>
                        <div id="more-{{job.id}}" style="display:none;"> 
                            <div style="font-size:14px;"><span class="fw-bold">Salary: </span>{{job.salary}} LPA</div>
                            <div style="font-size:14px;"><span class="fw-bold">Location: </span>{{job.location}}</div>
                            <div style="font-size:14px;"><span class="fw-bold">Description: </span>{{job.description}}</div>
                        </div>
                    </li>
                {% empty %}
                    <h4 class="text-center mt-4">Jobs not found </h4>
                {% endfor %}
            </ul>
        </div>
</body>
</html>